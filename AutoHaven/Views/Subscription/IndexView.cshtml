@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@model List<AutoHaven.Models.SubscriptionPlanModel>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Auto Subscription</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        'deep-navy': '#0f172a',
                        'electric-blue': '#2563eb',
                        'dark-grey': '#1f2937',
                    }
                }
            }
        }
    </script>
    <style>
        details > summary {
            list-style: none;
        }

            details > summary::-webkit-details-marker {
                display: none;
            }
        
        .pricing-card {
            transition: all 0.3s ease-in-out;
        }

        .pricing-btn {
            transition: background-color 0.3s ease;
        }

        .badge {
            transition: opacity 0.3s ease;
        }
    </style>
</head>
<body class="bg-gray-50 dark:bg-gray-900 font-sans">

    <div class="w-full @@container">
        <div class="relative flex min-h-[380px] flex-col gap-6 overflow-hidden p-8 text-center items-center justify-center">

            <div class="absolute inset-0 w-full h-full">
                <img src="https://images.unsplash.com/photo-1494976388531-d1058494cdd8?auto=format&fit=crop&q=80&w=1920"
                     alt="Luxury Car Background"
                     class="w-full h-full object-cover object-center" />
            </div>

            <div class="absolute inset-0 bg-deep-navy/75 z-0"></div>

            <div class="relative z-10 flex flex-col gap-3 max-w-3xl mt-4">
                <h1 class="text-white text-3xl font-black leading-tight tracking-[-0.033em] md:text-5xl drop-shadow-lg">
                    Reach Easier, Grow Faster.
                </h1>
                <p class="text-gray-200 text-sm font-normal leading-normal md:text-base drop-shadow-md max-w-xl mx-auto">
                    Unlock exclusive access to our services with plans designed for every provider. Simple, flexible, and all-inclusive.
                </p>
            </div>
        </div>
    </div>

    <div id="pricing-container"
         class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 pt-12 px-4 max-w-7xl mx-auto items-start">

        @foreach (var plan in Model)
        {
            string cardId = $"card-{plan.SubscriptionName.ToLower()}";

            <div id="@cardId"
                 onclick="selectPlan('@cardId')"
                 class="pricing-card cursor-pointer flex flex-1 flex-col gap-6 rounded-xl
                        border border-solid border-gray-200 bg-white p-8 shadow-sm group
                        @(plan.tier == AutoHaven.Models.SubscriptionPlanModel.Tiers.Pro
                                         ? "border-2 border-electric-blue transform md:scale-105 shadow-xl z-10"
                                         : "")">

            <div class="flex flex-col gap-2">
                <div class="flex justify-between items-center w-full min-h-[24px]">
                    <h3 class="text-dark-grey text-xl font-bold leading-tight">
                        @plan.SubscriptionName
                    </h3>

                    @if (plan.tier == AutoHaven.Models.SubscriptionPlanModel.Tiers.Pro)
                        {
                            <span class="badge opacity-100 text-white text-xs font-bold rounded-full bg-electric-blue px-3 py-1">
                                Most Popular
                            </span>
                        }
                        else if (plan.tier == AutoHaven.Models.SubscriptionPlanModel.Tiers.Starter)
                        {
                            <span class="badge opacity-0 text-white text-xs font-bold rounded-full bg-electric-blue px-3 py-1">
                                Basic
                            </span>
                        }
                        else
                        {
                            <span class="badge opacity-0 text-white text-xs font-bold rounded-full bg-electric-blue px-3 py-1">
                                Premium
                            </span>
                        }
                    </div>

                <p class="flex items-baseline gap-1 text-dark-grey">
                    <span class="text-4xl font-black leading-tight tracking-[-0.033em]">
                        $@plan.PricePerMonth
                    </span>
                    <span class="text-base font-bold leading-tight">/month</span>
                </p>
            </div>

            <button onclick="window.location.href='@Url.Action("Payment", "Subscription", new { planId = plan.SubscriptionPlanId })'"
                    class="pricing-btn flex w-full cursor-pointer items-center justify-center rounded-lg h-11 px-4
                           @(plan.tier == AutoHaven.Models.SubscriptionPlanModel.Tiers.Pro 
                               ? "bg-electric-blue text-white" 
                               : "bg-deep-navy text-white") text-sm font-bold hover:opacity-90">
                @GetButtonText(plan)
            </button>

                <div class="flex flex-col gap-3">
                    <div class="text-sm font-normal flex items-center gap-3 text-gray-600">
                        <span class="material-symbols-outlined text-electric-blue text-lg">check_circle</span>
                        Car Listings up to @plan.MaxCarListing
                    </div>

                    <div class="text-sm font-normal flex items-center gap-3 text-gray-600">
                        <span class="material-symbols-outlined text-electric-blue text-lg">check_circle</span>
                         @if (plan.tier == AutoHaven.Models.SubscriptionPlanModel.Tiers.Starter){
                        <p>Standard Control</p>}
                        else{<p>Featured Cars up to @plan.FeatureSlots</p>}
                    </div>
                </div>

            </div>
                }
    </div>

    <div class="mt-16 mb-12">
        <h2 class="text-dark-grey dark:text-white text-3xl font-bold px-4 pb-6 pt-5 text-center">Frequently Asked Questions</h2>
        <div class="flex flex-col p-4 max-w-3xl mx-auto">
            <details class="accordion-item flex flex-col border-t border-t-gray-200 dark:border-t-gray-700 py-3 group">
                <summary class="flex cursor-pointer items-center justify-between gap-6 py-2 list-none">
                    <p class="text-dark-grey dark:text-gray-200 text-base font-medium">Can I cancel my subscription at any time?</p>
                    <span class="material-symbols-outlined text-dark-grey dark:text-gray-200 group-open:rotate-180 transition-transform">expand_more</span>
                </summary>
                <p class="text-gray-600 dark:text-gray-400 text-sm pb-2 pt-1">Yes, you can cancel your subscription at any time through your account dashboard.</p>
            </details>
            <details class="accordion-item flex flex-col border-t border-b border-t-gray-200 dark:border-t-gray-700 border-b-gray-200 dark:border-b-gray-700 py-3 group">
                <summary class="flex cursor-pointer items-center justify-between gap-6 py-2 list-none">
                    <p class="text-dark-grey dark:text-gray-200 text-base font-medium">Are there any hidden fees?</p>
                    <span class="material-symbols-outlined text-dark-grey dark:text-gray-200 group-open:rotate-180 transition-transform">expand_more</span>
                </summary>
                <p class="text-gray-600 dark:text-gray-400 text-sm pb-2 pt-1">No, our pricing is all-inclusive. Only taxes and tolls are extra.</p>
            </details>
        </div>
    </div>

    <script>
        function selectPlan(selectedCardId) {
            const cards = ['card-starter', 'card-pro', 'card-elite'];

            cards.forEach(cardId => {
                const cardEl = document.getElementById(cardId);
                const buttonEl = cardEl.querySelector('button');
                const badgeEl = cardEl.querySelector('.badge');

                if (cardId === selectedCardId) {
                    
                    cardEl.classList.remove('border-gray-200');
                    cardEl.classList.add('border-2', 'border-electric-blue');

                    
                    cardEl.classList.add('md:scale-105', 'shadow-xl', 'z-10');
                    cardEl.classList.remove('shadow-sm');

                   
                    buttonEl.classList.remove('bg-deep-navy');
                    buttonEl.classList.add('bg-electric-blue');

                    
                    badgeEl.classList.remove('opacity-0');
                    badgeEl.classList.add('opacity-100');

                } else {
                    
                    cardEl.classList.add('border-gray-200');
                    cardEl.classList.remove('border-2', 'border-electric-blue');

                    
                    cardEl.classList.remove('md:scale-105', 'shadow-xl', 'z-10');
                    cardEl.classList.add('shadow-sm');

                    
                    buttonEl.classList.add('bg-deep-navy');
                    buttonEl.classList.remove('bg-electric-blue');

                    
                    badgeEl.classList.add('opacity-0');
                    badgeEl.classList.remove('opacity-100');
                }
            });
        }
       
        const detailsElements = document.querySelectorAll('details.accordion-item');
        detailsElements.forEach((details) => {
            details.addEventListener('toggle', (e) => {
                if (details.open) {
                    detailsElements.forEach((otherDetails) => {
                        if (otherDetails !== details && otherDetails.open) {
                            otherDetails.removeAttribute('open');
                        }
                    });
                }
            });
        });
    </script>
</body>
</html>
@functions {
    string GetButtonText(AutoHaven.Models.SubscriptionPlanModel plan)
    {
        return plan.tier switch
        {
            AutoHaven.Models.SubscriptionPlanModel.Tiers.Starter => "Get Started",
            AutoHaven.Models.SubscriptionPlanModel.Tiers.Pro => "Go Pro",
            AutoHaven.Models.SubscriptionPlanModel.Tiers.Elite => "Become Elite",
            _ => "Select"
        };
    }
}